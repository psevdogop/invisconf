!function(e,t){"use strict";function n(e){if(e=e[0],e.previousElementSibling)return t.element(e.previousElementSibling);for(var n=e.previousSibling;null!=n&&1!=n.nodeType;)n=n.previousSibling;return t.element(n)}function o(e,t){var o=n(e);o.length>0?o.after(t):e.parent().prepend(t)}function r(e,n){return e instanceof t.element&&(e=e[0]),null!==s?e[s](n):void 0}var i=t.module("angular-sortable-view",[]);i.directive("svRoot",[function(){function e(e,t,n){return n?e.x-t.x<0:e.y-t.y<0}function t(e){return l[e]}function n(e){delete l[e]}var i,l=Object.create(null);return{restrict:"A",controller:["$scope","$attrs","$interpolate","$parse",function(s,a,c,d){var p=c(a.svRoot)(s)||s.$id;l[p]||(l[p]=[]);var u,m,v,h,f,g,$,y=!1,x=d(a.svOnSort);a.svOnStart=a.$$element[0].attributes["sv-on-start"],a.svOnStart=a.svOnStart&&a.svOnStart.value,a.svOnStop=a.$$element[0].attributes["sv-on-stop"],a.svOnStop=a.svOnStop&&a.svOnStop.value;var w=d(a.svOnStart),b=d(a.svOnStop);if(this.sortingInProgress=function(){return i},a.svGrid){if(y="true"===a.svGrid?!0:"false"===a.svGrid?!1:null,null===y)throw"Invalid value of sv-grid attribute"}else s.$watchCollection(function(){return t(p)},function(e){y=!1;var t=e.filter(function(e){return!e.container}).map(function(e){return{part:e.getPart().id,y:e.element[0].getBoundingClientRect().top}}),n=Object.create(null);t.forEach(function(e){n[e.part]?n[e.part].push(e.y):n[e.part]=[e.y]}),Object.keys(n).forEach(function(e){n[e].sort(),n[e].forEach(function(t,o){o<n[e].length-1&&t>0&&t===n[e][o+1]&&(y=!0)})})});this.$moveUpdate=function(n,l,a,c,d,x,b){var S=a[0].getBoundingClientRect();"element"===n.tolerance&&(l={x:~~(S.left+S.width/2),y:~~(S.top+S.height/2)}),i=!0,u=[],m||(d?(m=d.clone(),m.removeClass("ng-hide")):(m=c.clone(),m.addClass("sv-visibility-hidden"),m.addClass("sv-placeholder"),m.css({height:S.height+"px",width:S.width+"px"})),$=c[0].nextSibling,c.after(m),c[0].parentNode.removeChild(c[0]),c.removeClass("sv-visibility-hidden"),f=c,v=n,h=a,w(s,{$helper:h,$part:x.model(x.scope),$index:b,$item:x.model(x.scope)[b]}),s.$root&&(s.$root.$$phase||s.$apply())),h[0].reposition({x:l.x+document.body.scrollLeft-l.offset.x*S.width,y:l.y+document.body.scrollTop-l.offset.y*S.height}),t(p).forEach(function(t){if(null==n.containment||r(t.element,n.containment)||r(t.element,n.containment+" *")){var o=t.element[0].getBoundingClientRect(),i={x:~~(o.left+o.width/2),y:~~(o.top+o.height/2)};t.container||!t.element[0].scrollHeight&&!t.element[0].scrollWidth||u.push({element:t.element,q:(i.x-l.x)*(i.x-l.x)+(i.y-l.y)*(i.y-l.y),view:t.getPart(),targetIndex:t.getIndex(),after:e(i,l,y)}),t.container&&!t.element[0].querySelector("[sv-element]:not(.sv-placeholder):not(.sv-source)")&&u.push({element:t.element,q:(i.x-l.x)*(i.x-l.x)+(i.y-l.y)*(i.y-l.y),view:t.getPart(),targetIndex:0,container:!0})}});var C=m[0].getBoundingClientRect(),E={x:~~(C.left+C.width/2),y:~~(C.top+C.height/2)};u.push({q:(E.x-l.x)*(E.x-l.x)+(E.y-l.y)*(E.y-l.y),element:m,placeholder:!0}),u.sort(function(e,t){return e.q-t.q}),u.forEach(function(e,t){0!==t||e.placeholder||e.container?0===t&&e.container?(g=e,e.element.append(m)):e.element.removeClass("sv-candidate"):(g=e,e.element.addClass("sv-candidate"),e.after?e.element.after(m):o(e.element,m))})},this.$drop=function(e,t,n){function o(){if(i=!1,m.remove(),h.remove(),$.parentNode.insertBefore(f[0],$),u=void 0,m=void 0,n=void 0,h=void 0,f=void 0,b(s,{$part:e.model(e.scope),$index:t,$item:e.model(e.scope)[t]}),g){g.element.removeClass("sv-candidate");var o=e.model(e.scope).splice(t,1),r=g.targetIndex;g.view===e&&g.targetIndex>t&&r--,g.after&&r++,g.view.model(g.view.scope).splice(r,0,o[0]),(g.view!==e||t!==r)&&x(s,{$partTo:g.view.model(g.view.scope),$partFrom:e.model(e.scope),$item:o[0],$indexTo:r,$indexFrom:t})}g=void 0,s.$root&&(s.$root.$$phase||s.$apply())}if(m)if(n.revert){var r=m[0].getBoundingClientRect(),l=h[0].getBoundingClientRect(),a=Math.sqrt(Math.pow(l.top-r.top,2)+Math.pow(l.left-r.left,2)),c=+n.revert*a/200;c=Math.min(c,+n.revert),["-webkit-","-moz-","-ms-","-o-",""].forEach(function(e){"undefined"!=typeof h[0].style[e+"transition"]&&(h[0].style[e+"transition"]="all "+c+"ms ease")}),setTimeout(o,c),h.css({top:r.top+document.body.scrollTop+"px",left:r.left+document.body.scrollLeft+"px"})}else o()},this.addToSortableElements=function(e){t(p).push(e)},this.removeFromSortableElements=function(e){var o=t(p),r=o.indexOf(e);r>-1&&(o.splice(r,1),0===o.length&&n(p))}}]}}]),i.directive("svPart",["$parse",function(e){return{restrict:"A",require:"^svRoot",controller:["$scope",function(e){e.$ctrl=this,this.getPart=function(){return e.part},this.$drop=function(t,n){e.$sortableRoot.$drop(e.part,t,n)}}],scope:!0,link:function(t,n,o,r){if(!o.svPart)throw new Error("no model provided");var i=e(o.svPart);if(!i.assign)throw new Error("model not assignable");t.part={id:t.$id,element:n,model:i,scope:t},t.$sortableRoot=r;var l={element:n,getPart:t.$ctrl.getPart,container:!0};r.addToSortableElements(l),t.$on("$destroy",function(){r.removeFromSortableElements(l)})}}}]),i.directive("svElement",["$parse",function(e){return{restrict:"A",require:["^svPart","^svRoot"],controller:["$scope",function(e){e.$ctrl=this}],link:function(n,o,r,i){function l(l){function s(e){u||(o.parent().prepend(h),u=!0),i[1].$moveUpdate(c,{x:e.clientX,y:e.clientY,offset:$},h,o,p,i[0].getPart(),n.$index)}if(!i[1].sortingInProgress()&&0==l.button){u=!1;var c=e(r.svElement)(n);if(c=t.extend({},{tolerance:"pointer",revert:200,containment:"html"},c),c.containment)var v=a.call(o,c.containment)[0].getBoundingClientRect();var h,f=o,g=o[0].getBoundingClientRect();d||(d=i[0].helper),p||(p=i[0].placeholder),d?(h=d.clone(),h.removeClass("ng-hide"),h.css({left:g.left+document.body.scrollLeft+"px",top:g.top+document.body.scrollTop+"px"}),f.addClass("sv-visibility-hidden")):(h=f.clone(),h.addClass("sv-helper").css({left:g.left+document.body.scrollLeft+"px",top:g.top+document.body.scrollTop+"px",width:g.width+"px"})),h[0].reposition=function(e){var t=e.x,n=e.y,o=h[0].getBoundingClientRect(),r=document.body;v&&(n<v.top+r.scrollTop&&(n=v.top+r.scrollTop),n+o.height>v.top+r.scrollTop+v.height&&(n=v.top+r.scrollTop+v.height-o.height),t<v.left+r.scrollLeft&&(t=v.left+r.scrollLeft),t+o.width>v.left+r.scrollLeft+v.width&&(t=v.left+r.scrollLeft+v.width-o.width)),this.style.left=t-r.scrollLeft+"px",this.style.top=n-r.scrollTop+"px"};var $={x:(l.clientX-g.left)/g.width,y:(l.clientY-g.top)/g.height};m.addClass("sv-sorting-in-progress"),m.on("mousemove",s).on("mouseup",function y(){m.off("mousemove",s),m.off("mouseup",y),m.removeClass("sv-sorting-in-progress"),u?i[0].$drop(n.$index,c):o.removeClass("sv-visibility-hidden")})}}var s={element:o,getPart:i[0].getPart,getIndex:function(){return n.$index}};i[1].addToSortableElements(s),n.$on("$destroy",function(){i[1].removeFromSortableElements(s)});var c=o;c.on("mousedown",l),n.$watch("$ctrl.handle",function(e){e&&(c.off("mousedown",l),c=e,c.on("mousedown",l))});var d;n.$watch("$ctrl.helper",function(e){e&&(d=e)});var p;n.$watch("$ctrl.placeholder",function(e){e&&(p=e)});var u,m=(t.element(document.body),t.element(document.documentElement))}}}]),i.directive("svHandle",function(){return{require:"?^svElement",link:function(e,t,n,o){o&&(o.handle=t.add(o.handle))}}}),i.directive("svHelper",function(){return{require:["?^svPart","?^svElement"],link:function(e,t,n,o){t.addClass("sv-helper").addClass("ng-hide"),o[1]?o[1].helper=t:o[0]&&(o[0].helper=t)}}}),i.directive("svPlaceholder",function(){return{require:["?^svPart","?^svElement"],link:function(e,t,n,o){t.addClass("sv-placeholder").addClass("ng-hide"),o[1]?o[1].placeholder=t:o[0]&&(o[0].placeholder=t)}}}),t.element(document.head).append(["<style>.sv-helper{position: fixed !important;z-index: 99999;margin: 0 !important;}.sv-candidate{}.sv-placeholder{}.sv-sorting-in-progress{-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.sv-visibility-hidden{visibility: hidden !important;opacity: 0 !important;}</style>"].join(""));var l=document.documentElement,s=l.matches?"matches":l.matchesSelector?"matchesSelector":l.webkitMatches?"webkitMatches":l.webkitMatchesSelector?"webkitMatchesSelector":l.msMatches?"msMatches":l.msMatchesSelector?"msMatchesSelector":l.mozMatches?"mozMatches":l.mozMatchesSelector?"mozMatchesSelector":null;if(null==s)throw"This browser doesn't support the HTMLElement.matches method";var a=t.element.prototype.closest||function(e){for(var n=this[0].parentNode;n!==document.documentElement&&!n[s](e);)n=n.parentNode;return n[s](e)?t.element(n):t.element()}}(window,window.angular);